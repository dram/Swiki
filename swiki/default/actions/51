| values addresses test key |values _ shelf formatBookAction: 'setup' request: request response: response book: book.addresses _ OrderedCollection new.book forbidWriting.values do: [:value | (value class = Array) ifTrue: [	key _ value at: 1.	(request fieldsHasKey: key) ifTrue: [		((value at: 3) isKindOf: String)			ifTrue: [test _ request fieldsKey: key]			ifFalse: [test _ request fieldsAsBooleanKey: key].		((value at: 3) = test) ifFalse: [			book setup at: (value at: 1) put: test.			(value at: 5) ifNotNil: [(addresses includes: (value at: 5))				ifFalse: [addresses add: (value at: 5)]]]]]]."Do Addresses"addresses do: [:address | book formatPrivAddress: address request: request response: response shelf: shelf]."Store Changes"shelf writeSetupForBook: book.book permitWriting."Return Forward to Setup"response	at: 'headerStatus' put: #tempMoved;	at: 'location' put: (request referenceShelf: shelf address: ('admin/setup?book=', book name)).shelf formatShelfTemplate: 'location' request: request response: response