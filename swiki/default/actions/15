| dir prefix versions img ref return |dir _ request settingsAt: 'dir'.prefix _ request settingsAt: 'prefix'.versions _ (request settingsAt: 'file') versions.return _ WriteStream on: String new."Add a link to progression if an image"versions isAnImage ifTrue: [return	nextPutAll: '<a href="';	nextPutAll: prefix;	nextPutAll: dir httpPath;	nextPutAll: versions first httpName;	nextPutAll: '?history=true&amp;show=true">View all versions of this image.</a><br>';	nextPutAll: String crlf].return nextPutAll: ('<table border=0 cellpadding=2 cellspacing=0>', String crlf, '<tr><td></td><td><em>name</em></td><td align=right>&nbsp;&nbsp;<em>size</em></td><td align=right>&nbsp;&nbsp;<em>date</em></td></tr>', String crlf, '<tr><td colspan=4><hr size=1 noshade></td></tr>', String crlf).img _ (shelf modulesAt: 'colorScheme') mime: (versions mimeType copyUpTo: $/) alt: versions strictXmlName.versions do: [:entry |	ref _ prefix, dir httpPath, entry httpName.	return		nextPutAll: '<tr><td><a href="';		nextPutAll: ref;		nextPutAll: '">';		nextPutAll: img;		nextPutAll: '</a></td><td><a href="';		nextPutAll: ref;		nextPutAll: '">';		nextPutAll: entry xmlName;		nextPutAll: '</a></td><td align=right>&nbsp;&nbsp;';		nextPutAll: entry fileSizeInWords;		nextPutAll: '</td><td align=right>&nbsp;&nbsp;';		nextPutAll: (NuSwikiPage printDate: entry modificationDate);		nextPutAll: '</td></tr>';		nextPutAll: String crlf].return	nextPutAll: '</table>';	contents