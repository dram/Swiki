| newVersion oldVersion newDiff oldDiff result |"YUK!!!!!"newVersion _ request settingsAt: 'newVersion'.oldVersion _ request settingsAt: 'oldVersion'.result _ ReadWriteStream on: String new."Name"(newVersion showName = oldVersion showName)	ifTrue: [result		nextPutAll: '<tt><font size="+1">';		nextPutAll: newVersion showName;		nextPutAll: '</font></tt><br>';		nextPutAll: String crlf]	ifFalse: [result		nextPutAll: '<tt><font size="+1"><s>';		nextPutAll: oldVersion showName;		nextPutAll: '</s><br>';		nextPutAll: String crlf;		nextPutAll: '<b>';		nextPutAll: newVersion showName;		nextPutAll: '</b></font></tt><br>';		nextPutAll: String crlf]."Body"(page isAForm)	ifTrue: [1 to: (newVersion text size) do: [:i |		newDiff _ (newVersion editFormat: (newVersion textKey: i asString) request: request response: response shelf: shelf book: book) findTokens: String crlf.		oldDiff _ (oldVersion editFormat: (oldVersion textKey: i asString) request: request response: response shelf: shelf book: book) findTokens: String crlf.		"Use diff.priv address"		request settingsAt: 'newDiff' put: newDiff.		request settingsAt: 'oldDiff' put: oldDiff.		result			nextPutAll: (book formatBookAction: 'bar' request: request response: response shelf: shelf);			nextPutAll: String crlf;			nextPutAll: '<tt>';			nextPutAll: (book formatPrivAddress: 'diff' request: request response: response shelf: shelf);			nextPutAll: '</tt>']]	ifFalse: [		newDiff _ (newVersion editFormatRequest: request response: response shelf: shelf book: book) findTokens: String crlf.		oldDiff _ (oldVersion editFormatRequest: request response: response shelf: shelf book: book) findTokens: String crlf.		"Use diff.priv address"		request settingsAt: 'newDiff' put: newDiff.		request settingsAt: 'oldDiff' put: oldDiff.		result			nextPutAll: (book formatBookAction: 'bar' request: request response: response shelf: shelf);			nextPutAll: String crlf;			nextPutAll: '<tt>';			nextPutAll: (book formatPrivAddress: 'diff' request: request response: response shelf: shelf);			nextPutAll: '</tt>']."Return contents"result contents