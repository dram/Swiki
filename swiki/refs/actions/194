| lockCondition |lockCondition _ request fieldsKey: 'lock' ifAbsent: ['open'].(lockCondition = 'open')	ifTrue: ["Save the page without password information"		[page			forbidWriting;			clearRefsCache;			time: (Time now);			date: (Date today);			saveFormat: (request text) request: request response: response shelf: shelf book: book;			nameUnique: (request fieldsKey: 'name') book: book;			user: 'unknown';			alertsFrom: request] ifError: [:a :b | "Do nothing"].		"Fork off writing the page to make it faster"		[	[page				user: (shelf formatPrivAddress: 'getIPName' request: request response: response);				backup;				write.] ifError: [:a :b | "Do nothing"].			page				permitWriting;				sendAlerts: request response: response shelf: shelf book: book] fork.		response at: 'headerStatus' put: #tempMoved.		response at: 'location' put: (request referenceShelf: shelf book: book page: page).		book formatPageTemplate: 'saveSuccess' request: request response: response shelf: shelf page: page]	ifFalse: [(page passwordMatches: request response: response shelf: shelf book: book)		ifTrue: ["Save the page"			book formatPageAction: 'saveUnlocked' request: request response: response shelf: shelf page: page]		ifFalse: ["Save failed"			book formatPageTemplate: 'saveFailedOpen' request: request response: response shelf: shelf page: page]]