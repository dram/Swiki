| thumbnails versionId image path alt |thumbnails _ request settingsAt: 'thumbnails'.versionId _ page versionId.versionId caseOf: {	[0]->["Current"		thumbnails			ifNil: [(page settingsIncludes: 'template')				ifTrue: [					request settingsAt: 'formsFileName' put: ((page settingsAt: 'template'), '.gif').					image _ book formatPrivAddress: 'formsThumbAndPath' request: request response: response shelf: shelf.					path _ image at: 2.					image _ image at: 1]				ifFalse: [					image _ (((shelf modulesAt: 'files') directoryNamed: 'plug-in') fileVersionsAt: 'thumbnail.gif') last.					path _ (shelf settingsAt: 'fileServerPath'), 'plug-in/', image httpName]]			ifNotNil: [image _ thumbnails last.				path _ (book settingsAt: 'uploadServerPath'), (page id asString), '/', image httpName].		alt _ 'Current'].	[1]->["First Version"		(page settingsIncludes: 'template')			ifTrue: [				request settingsAt: 'formsFileName' put: ((page settingsAt: 'template'), '.gif').			image _ book formatPrivAddress: 'formsThumbAndPath' request: request response: response shelf: shelf.				path _ image at: 2.				image _ image at: 1]			ifFalse: [				image _ (((shelf modulesAt: 'files') directoryNamed: 'plug-in') fileVersionsAt: 'thumbnail.gif') last.				path _ (shelf settingsAt: 'fileServerPath'), 'plug-in/', image httpName].		alt _ 'Version 1']}	otherwise: [		image _ thumbnails at: (versionId - 1).		path _ (book settingsAt: 'uploadServerPath'), (page id asString), '/', image httpName.		alt _ 'Version ', versionId asString].image isAnImage	ifTrue: ['<img src="', path, '" border=2 width=', (image width asString), ' height=', (image height asString), ' alt="', alt, '">']	ifFalse: [alt]