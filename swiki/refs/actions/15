| sortedPages date return |sortedPages _ (book pages asSortedCollection: [:x :y | (x date = y date) ifTrue: [x time > y time] ifFalse: [x date > y date]]) asOrderedCollection.date _ nil.return _ WriteStream on: String new.sortedPages do: [:page |	(date notNil and: [page date = date]) ifFalse: [		date ifNotNil: ["End Previous"			return				nextPutAll: '</ul>';				nextPutAll: String crlf].		date _ page date.		return			nextPutAll: '<h3>';			nextPutAll: page printDate;			nextPutAll: '</h3>';			nextPutAll: String crlf;			nextPutAll: '<ul>';			nextPutAll: String crlf].	return nextPutAll: (book formatPageTemplate: 'recentListing' request: request response: response shelf: shelf page: page)].return	nextPutAll: '</ul>';	nextPutAll: String crlf;	contents