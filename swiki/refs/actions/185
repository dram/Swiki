| options month year isFixed error |options _ request settingsAt: 'options'.isFixed _ false.error _ nil."Establish the numerical month"(options includesKey: 'month')	ifTrue: [		month _ options at: 'month'.		month isAllDigits			ifTrue: [month _ month asNumber.				((1 to: 12) includes: month)					ifTrue: [isFixed _ true]					ifFalse: [error _ 'invalid month']]			ifFalse: [error _ 'invalid month']]	ifFalse: [(request fieldsHasKey: 'month')		ifTrue: [month _ request fieldsAsNumberKey: 'month'.			((1 to: 12) includes: month) ifFalse: [error _ 'invalid month']]		ifFalse: [month _ Date today month index]]."Establish the Year"error ifNil: [	(options includesKey: 'year')		ifTrue: [year _ options at: 'year'.			year isAllDigits				ifTrue: [year _ year asNumber]				ifFalse: [error _ 'invalid year']]		ifFalse: [year _ request fieldsAsNumberKey: 'year' ifAbsent: [Date today year]]]."Return error or do calendar"error	ifNil: [request settingsAt: 'month' put: (Month month: month year: year).		book formatPageTemplate: (isFixed ifTrue: ['calendarFixed'] ifFalse: ['calendar']) request: request response: response shelf: shelf page: page]	ifNotNil: ['<b>Calendar error: ', error, '</b>']