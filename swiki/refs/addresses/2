| securityModule realm |(securityModule _ book rawModules at: 'security' ifAbsent: [nil])	ifNil: [nil]	ifNotNil: [(securityModule process: request response: response shelf: shelf book: book)		ifTrue: [nil]		ifFalse: ["Unauthorized"			realm _ request referenceShelf: shelf book: book address: '*'.			response at: 'headerStatus' put: #unauthorized.			response at: 'contentType' put: MIMEDocument contentTypePlainText.			response at: 'authenticate' put: ('Basic realm="', realm, '"').			'Unauthorized for: ', realm]]