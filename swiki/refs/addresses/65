| dir file image |dir _ (book modulesAt: 'uploads') directoryNamed: 'forms'.file _ request settingsAt: 'formsFileName'.(dir fileRefsExists: file)	ifTrue: [Array		with: (image _ (dir fileVersionsAt: file) last)		with: ((book settingsAt: 'uploadServerPath'), dir httpPath, image httpName)]	ifFalse: [book hasParent		ifTrue: [book parent formatPrivAddress: 'formsFileUrl' request: request response: response shelf: shelf]		ifFalse: [Array			with: (image _ (((shelf modulesAt: 'files') directoryNamed: 'plug-in') fileVersionsAt: 'thumbnail.gif') last)			with: ((shelf settingsAt: 'fileServerPath'), 'plug-in/', image httpName)]]