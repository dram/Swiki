| newDiff oldDiff addColl subColl oldEntry i test result |"This is used by diff.page to diff the page"newDiff _ request settingsAt: 'newDiff'.oldDiff _ request settingsAt: 'oldDiff'.result _ ReadWriteStream on: String new.addColl _ OrderedCollection new.subColl _ OrderedCollection new.newDiff do: [:newEntry |	i _ 0.	test _ true.	[test] whileTrue: [i _ i + 1.		oldEntry _ oldDiff at: i ifAbsent: [test _ false].		(oldEntry = newEntry)			ifTrue: [				"Add subColl entries"				subColl isEmpty ifFalse: [					result nextPutAll: '<s>'.					subColl do: [:entry | result						nextPutAll: entry;						nextPutAll: '<br>';						nextPutAll: String crlf].					result nextPutAll: '</s>'.					subColl _ OrderedCollection new].				"Add addColl entries"				addColl isEmpty ifFalse: [					result nextPutAll: '<b>'.					addColl do: [:entry | result						nextPutAll: entry;						nextPutAll: '<br>';						nextPutAll: String crlf].					result nextPutAll: '</b>'.					addColl _ OrderedCollection new].				"Add current entry"				result					nextPutAll: newEntry;					nextPutAll: '<br>';					nextPutAll: String crlf.				"Change oldDiff"				(i = oldDiff size)					ifTrue: [oldDiff _ OrderedCollection new]					ifFalse: [oldDiff _ oldDiff copyFrom: (i+1) to: (oldDiff size)].				oldEntry _ true.				test _ false]			ifFalse: [(oldEntry = false) ifFalse: [subColl add: oldEntry]]].	(oldEntry = true) ifFalse: [		addColl add: newEntry.		subColl _ OrderedCollection new]]."Add Remaining oldDiff to subColl"subColl addAll: oldDiff."Add subColl entries"subColl isEmpty ifFalse: [	result nextPutAll: '<s>'.	subColl do: [:entry | result		nextPutAll: entry;		nextPutAll: '<br>';		nextPutAll: String crlf].	result nextPutAll: '</s>']."Add addColl entries"addColl isEmpty ifFalse: [	result nextPutAll: '<b>'.	addColl do: [:entry | result		nextPutAll: entry;		nextPutAll: '<br>';		nextPutAll: String crlf].	result nextPutAll: '</b>']."Return contents"result contents